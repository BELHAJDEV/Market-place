{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import'./edit.css';import{SideBarContext}from'../../contexts/SideBarContext';import{storage,db}from'../../Firebase';import firebase from'firebase/compat';import{Zoom}from'react-reveal';import{Link,useNavigate,useParams}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Edit(){var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),imagesSelected=_useState2[0],setImagesSelected=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),imagesName=_useState4[0],setImagesName=_useState4[1];var _useContext=useContext(SideBarContext),value2=_useContext.value2;var _value=_slicedToArray(value2,2),activeUser=_value[0],setActiveUser=_value[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),title=_useState6[0],setTitle=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),price=_useState8[0],setPrice=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),category=_useState10[0],setCategory=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),place=_useState12[0],setPlace=_useState12[1];useEffect(function(){db.collection('posts').doc(id).onSnapshot(function(snapshot){setTitle(snapshot.data().productName);setPrice(snapshot.data().price);setPlace(snapshot.data().place);setCategory(snapshot.data().category);});},[id]);var i=-1;var hundleSelect=function hundleSelect(){var input=document.getElementById('file');input.click();i++;};var hundleChange=function hundleChange(e){if(e.target.value!==''){setImagesSelected([e.target.files[i]].concat(_toConsumableArray(imagesSelected)));setImagesName([e.target.files[i].name].concat(_toConsumableArray(imagesName)));}};var j=0;var content=[];var Add=function Add(){db.collection('posts').doc(id).set({productName:title,price:price,imagesUrl:content,username:activeUser,place:place,category:category,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setImagesSelected([]);navigate('/');};var saveArticle=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();imagesSelected.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(image){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return storage.ref(\"images/\".concat(image.name)).put(image);case 2:_context.next=4;return storage.ref('images').child(image.name).getDownloadURL().then(function(url){content.unshift(url);j++;});case 4:if(j===imagesSelected.length){Add();}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());setPlace('');setTitle('');setCategory('');setPrice('');case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function saveArticle(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Zoom,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"file\",onChange:hundleChange,name:\"\",id:\"file\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"add_container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Edit Post\"}),/*#__PURE__*/_jsx(\"div\",{className:\"data_container\",onClick:hundleSelect,children:/*#__PURE__*/_jsxs(\"h4\",{children:[imagesSelected.length,\" Selected +\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"details\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",name:\"\",id:\"\",value:title,onChange:function onChange(e){return setTitle(e.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"price\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Price\",name:\"\",id:\"\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"category\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Category\",name:\"\",id:\"\",value:category,onChange:function onChange(e){return setCategory(e.target.value);}}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-caret-down\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"place\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Place\",name:\"\",id:\"\",value:place,onChange:function onChange(e){return setPlace(e.target.value);}}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-marker-alt\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"save_article\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:saveArticle,children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Edit\"})})})]})})]})]})});}export default Edit;","map":{"version":3,"sources":["C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/src/components/Edit/Edit.js"],"names":["React","useState","useEffect","useContext","SideBarContext","storage","db","firebase","Zoom","Link","useNavigate","useParams","Edit","id","navigate","imagesSelected","setImagesSelected","imagesName","setImagesName","value2","activeUser","setActiveUser","title","setTitle","price","setPrice","category","setCategory","place","setPlace","collection","doc","onSnapshot","snapshot","data","productName","i","hundleSelect","input","document","getElementById","click","hundleChange","e","target","value","files","name","j","content","Add","set","imagesUrl","username","timestamp","firestore","FieldValue","serverTimestamp","saveArticle","preventDefault","map","image","ref","put","child","getDownloadURL","then","url","unshift","length"],"mappings":"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","sourcesContent":["import React,{useState,useEffect,useContext} from 'react';\r\nimport './edit.css';\r\nimport {SideBarContext} from '../../contexts/SideBarContext';\r\nimport {storage,db} from '../../Firebase';\r\nimport firebase from 'firebase/compat';\r\nimport { Zoom } from 'react-reveal';\r\nimport {Link,useNavigate,useParams} from 'react-router-dom'\r\n\r\nfunction Edit() {\r\n    let {id} = useParams();\r\n    let navigate = useNavigate()\r\n    const [imagesSelected,setImagesSelected] = useState([]);\r\n    const [imagesName,setImagesName] = useState([])\r\n    const {value2} = useContext(SideBarContext);  \r\n    const [activeUser,setActiveUser] = value2;\r\n    const [title,setTitle] = useState('');\r\n    const [price,setPrice] = useState('');\r\n    const [category,setCategory] = useState('');\r\n    const [place,setPlace] = useState('');\r\n\r\n    useEffect(()=>{\r\n        db\r\n        .collection('posts')\r\n        .doc(id)\r\n        .onSnapshot( snapshot => {\r\n            setTitle(snapshot.data().productName);\r\n            setPrice(snapshot.data().price);\r\n            setPlace(snapshot.data().place);\r\n            setCategory(snapshot.data().category)\r\n        })\r\n        \r\n\r\n    },[id])\r\n\r\n    let i =-1;\r\n    const hundleSelect = ()=> {\r\n        let input = document.getElementById('file');\r\n        input.click();\r\n        i++;    \r\n    }\r\n\r\n    const hundleChange = (e) =>{\r\n        \r\n        if(e.target.value !== ''){\r\n    \r\n            setImagesSelected([e.target.files[i],...imagesSelected]);\r\n            setImagesName([e.target.files[i].name,...imagesName])\r\n                     \r\n        }\r\n    }\r\n\r\nlet j = 0\r\n   let content = [];\r\n   const Add = ()=> {\r\n       db.collection('posts').doc(id).set({\r\n           productName : title,\r\n           price,\r\n           imagesUrl : content,\r\n           username : activeUser,\r\n           place,\r\n           category,\r\n           timestamp: firebase.firestore.FieldValue.serverTimestamp()\r\n\r\n\r\n       });\r\n       setImagesSelected([])\r\n       navigate('/')\r\n       \r\n   }\r\n    const saveArticle = async(e)=>{\r\n        e.preventDefault();\r\n        \r\n        \r\n         imagesSelected.map( async (image) => { \r\n            \r\n            await storage.ref(`images/${image.name}`).put(image);\r\n            await storage.ref('images').child(image.name).getDownloadURL().then(\r\n                url => {\r\n                    content.unshift(url);\r\n                    j++;\r\n                })\r\n        \r\n           \r\n            if(j === imagesSelected.length) {\r\n                Add()\r\n            }\r\n           \r\n        })\r\n        \r\n    \r\n        setPlace('');\r\n        setTitle('');\r\n        setCategory('');\r\n        setPrice('');\r\n        \r\n\r\n    }\r\n\r\n    return (\r\n        <Zoom>\r\n        <div className=\"container\">\r\n        \r\n        <input type=\"file\" className='file'\r\n            onChange={hundleChange}\r\n            name=\"\" id=\"file\" />\r\n\r\n        \r\n            <div className='add_container'>\r\n            <h3>Edit Post</h3>\r\n\r\n            <div className=\"data_container\"\r\n            onClick={hundleSelect}\r\n            >\r\n                  <h4>{imagesSelected.length} Selected +</h4>\r\n\r\n            </div>\r\n            <div className=\"details\">\r\n                <form action=\"\">\r\n                    <div className=\"title\">\r\n                        <input type=\"text\" placeholder='Title' name=\"\" id=\"\" value={title}\r\n                            onChange={(e)=> setTitle(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className=\"price\">\r\n                    <input type=\"text\" placeholder='Price' name=\"\" id=\"\" \r\n                         value={price}\r\n                        onChange={(e)=> setPrice(e.target.value)}\r\n                    />\r\n\r\n                    </div>\r\n                    <div className=\"category\">\r\n                    <input type=\"text\" placeholder='Category' name=\"\" id=\"\" \r\n                         value={category}\r\n                        onChange={(e)=> setCategory(e.target.value)}\r\n                    />\r\n                        <i className=\"fas fa-caret-down\"></i>             \r\n                    </div>\r\n                    <div className=\"place\">\r\n                        <input type=\"text\" placeholder='Place' name=\"\" id=\"\"\r\n                        value={place}\r\n                        onChange={(e)=> setPlace(e.target.value)}\r\n                         />\r\n                        <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </div>\r\n\r\n                    <div className=\"save_article\">\r\n                        <button type='submit' onClick={saveArticle}>\r\n                        <Link to='/'>\r\n                        Edit\r\n                        </Link>\r\n                        </button>\r\n                    </div>\r\n\r\n                    \r\n                </form>\r\n            </div>\r\n\r\n        \r\n            </div>\r\n            \r\n        </div>\r\n        \r\n        </Zoom>\r\n    )\r\n}\r\n\r\nexport default Edit\r\n"]},"metadata":{},"sourceType":"module"}