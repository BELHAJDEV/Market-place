{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import'./addPost.css';import{SideBarContext}from'../../contexts/SideBarContext';import{storage,db}from'../../Firebase';import firebase from'firebase/compat';import{Zoom}from'react-reveal';import{Link,useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AddPost(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),imagesSelected=_useState2[0],setImagesSelected=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),imagesName=_useState4[0],setImagesName=_useState4[1];var _useContext=useContext(SideBarContext),value2=_useContext.value2;var _value=_slicedToArray(value2,2),activeUser=_value[0],setActiveUser=_value[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),title=_useState6[0],setTitle=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),price=_useState8[0],setPrice=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),category=_useState10[0],setCategory=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),place=_useState12[0],setPlace=_useState12[1];var navigate=useNavigate();var i=-1;var hundleSelect=function hundleSelect(){var input=document.getElementById('file');input.click();i++;};var hundleChange=function hundleChange(e){if(e.target.value!==''){setImagesSelected([e.target.files[i]].concat(_toConsumableArray(imagesSelected)));setImagesName([e.target.files[i].name].concat(_toConsumableArray(imagesName)));}};var j=0;var content=[];var Add=function Add(){db.collection('posts').add({productName:title,price:price,imagesUrl:content,username:activeUser,place:place,category:category,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setImagesSelected([]);navigate('/');};var saveArticle=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();imagesSelected.map(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(image){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return storage.ref(\"images/\".concat(image.name)).put(image);case 2:_context.next=4;return storage.ref('images').child(image.name).getDownloadURL().then(function(url){content.unshift(url);j++;});case 4:if(j===imagesSelected.length){Add();}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());setPlace('');setTitle('');setCategory('');setPrice('');case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function saveArticle(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Zoom,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"file\",onChange:hundleChange,name:\"\",id:\"file\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"add_container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Add a Post\"}),/*#__PURE__*/_jsx(\"div\",{className:\"data_container\",onClick:hundleSelect,children:imagesSelected.length===0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-folder-plus\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"Add images\"})]}):/*#__PURE__*/_jsxs(\"h4\",{className:\"imgs_number\",children:[imagesSelected.length,\"+\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"details\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",name:\"\",id:\"\",value:title,onChange:function onChange(e){return setTitle(e.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"price\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Price\",name:\"\",id:\"\",value:price,onChange:function onChange(e){return setPrice(e.target.value);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"category\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Category\",name:\"\",id:\"\",value:category,onChange:function onChange(e){return setCategory(e.target.value);}}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-caret-down\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"place\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Place\",name:\"\",id:\"\",value:place,onChange:function onChange(e){return setPlace(e.target.value);}}),/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-marker-alt\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"save_article\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:saveArticle,children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Publish\"})})})]})})]})]})});}export default AddPost;","map":{"version":3,"sources":["C:/Users/Electro-Marke.ma/Documents/React-JS/market-place-app/src/components/addPost/AddPost.js"],"names":["React","useState","useContext","SideBarContext","storage","db","firebase","Zoom","Link","useNavigate","AddPost","imagesSelected","setImagesSelected","imagesName","setImagesName","value2","activeUser","setActiveUser","title","setTitle","price","setPrice","category","setCategory","place","setPlace","navigate","i","hundleSelect","input","document","getElementById","click","hundleChange","e","target","value","files","name","j","content","Add","collection","add","productName","imagesUrl","username","timestamp","firestore","FieldValue","serverTimestamp","saveArticle","preventDefault","map","image","ref","put","child","getDownloadURL","then","url","unshift","length"],"mappings":"qtBAAA,MAAOA,CAAAA,KAAP,EAAcC,QAAd,CAAuBC,UAAvB,KAAwC,OAAxC,CACA,MAAO,eAAP,CACA,OAAQC,cAAR,KAA6B,+BAA7B,CACA,OAAQC,OAAR,CAAgBC,EAAhB,KAAyB,gBAAzB,CACA,MAAOC,CAAAA,QAAP,KAAqB,iBAArB,CACA,OAASC,IAAT,KAAqB,cAArB,CACA,OAAQC,IAAR,CAAaC,WAAb,KAA+B,kBAA/B,C,6IAEA,QAASC,CAAAA,OAAT,EAAmB,CAEf,cAA2CT,QAAQ,CAAC,EAAD,CAAnD,wCAAOU,cAAP,eAAsBC,iBAAtB,eACA,eAAmCX,QAAQ,CAAC,EAAD,CAA3C,yCAAOY,UAAP,eAAkBC,aAAlB,eACA,gBAAiBZ,UAAU,CAACC,cAAD,CAA3B,CAAOY,MAAP,aAAOA,MAAP,CACA,0BAAmCA,MAAnC,IAAOC,UAAP,WAAkBC,aAAlB,WACA,eAAyBhB,QAAQ,CAAC,EAAD,CAAjC,yCAAOiB,KAAP,eAAaC,QAAb,eACA,eAAyBlB,QAAQ,CAAC,EAAD,CAAjC,yCAAOmB,KAAP,eAAaC,QAAb,eACA,eAA+BpB,QAAQ,CAAC,EAAD,CAAvC,0CAAOqB,QAAP,gBAAgBC,WAAhB,gBACA,gBAAyBtB,QAAQ,CAAC,EAAD,CAAjC,2CAAOuB,KAAP,gBAAaC,QAAb,gBAEA,GAAMC,CAAAA,QAAQ,CAAGjB,WAAW,EAA5B,CAGA,GAAIkB,CAAAA,CAAC,CAAE,CAAC,CAAR,CACA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAK,CACtB,GAAIC,CAAAA,KAAK,CAAGC,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAAZ,CACAF,KAAK,CAACG,KAAN,GACAL,CAAC,GACJ,CAJD,CAMA,GAAMM,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAM,CAEvB,GAAGA,CAAC,CAACC,MAAF,CAASC,KAAT,GAAmB,EAAtB,CAAyB,CAErBxB,iBAAiB,EAAEsB,CAAC,CAACC,MAAF,CAASE,KAAT,CAAeV,CAAf,CAAF,4BAAuBhB,cAAvB,GAAjB,CACAG,aAAa,EAAEoB,CAAC,CAACC,MAAF,CAASE,KAAT,CAAeV,CAAf,EAAkBW,IAApB,4BAA4BzB,UAA5B,GAAb,CAEH,CACJ,CARD,CAWD,GAAI0B,CAAAA,CAAC,CAAG,CAAR,CACA,GAAIC,CAAAA,OAAO,CAAG,EAAd,CACA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAK,CACbpC,EAAE,CAACqC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACvBC,WAAW,CAAG1B,KADS,CAEvBE,KAAK,CAALA,KAFuB,CAGvByB,SAAS,CAAGL,OAHW,CAIvBM,QAAQ,CAAG9B,UAJY,CAKvBQ,KAAK,CAALA,KALuB,CAMvBF,QAAQ,CAARA,QANuB,CAOvByB,SAAS,CAAEzC,QAAQ,CAAC0C,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EAPY,CAA3B,EAWAtC,iBAAiB,CAAC,EAAD,CAAjB,CACAc,QAAQ,CAAC,GAAD,CAAR,CAEH,CAfD,CAgBC,GAAMyB,CAAAA,WAAW,0FAAG,kBAAMjB,CAAN,sHAChBA,CAAC,CAACkB,cAAF,GAGCzC,cAAc,CAAC0C,GAAf,2FAAoB,iBAAOC,KAAP,wIAEXlD,CAAAA,OAAO,CAACmD,GAAR,kBAAsBD,KAAK,CAAChB,IAA5B,GAAoCkB,GAApC,CAAwCF,KAAxC,CAFW,8BAGXlD,CAAAA,OAAO,CAACmD,GAAR,CAAY,QAAZ,EAAsBE,KAAtB,CAA4BH,KAAK,CAAChB,IAAlC,EAAwCoB,cAAxC,GAAyDC,IAAzD,CACF,SAAAC,GAAG,CAAI,CACHpB,OAAO,CAACqB,OAAR,CAAgBD,GAAhB,EACArB,CAAC,GACJ,CAJC,CAHW,QAUjB,GAAGA,CAAC,GAAK5B,cAAc,CAACmD,MAAxB,CAAgC,CAC5BrB,GAAG,GACN,CAZgB,sDAApB,kEAiBDhB,QAAQ,CAAC,EAAD,CAAR,CACAN,QAAQ,CAAC,EAAD,CAAR,CACAI,WAAW,CAAC,EAAD,CAAX,CACAF,QAAQ,CAAC,EAAD,CAAR,CAxBgB,wDAAH,kBAAX8B,CAAAA,WAAW,4CAAjB,CA6BA,mBAEI,KAAC,IAAD,wBACA,aAAK,SAAS,CAAC,WAAf,wBAEA,cAAO,IAAI,CAAC,MAAZ,CAAmB,SAAS,CAAC,MAA7B,CACI,QAAQ,CAAElB,YADd,CAEI,IAAI,CAAC,EAFT,CAEY,EAAE,CAAC,MAFf,EAFA,cAOI,aAAK,SAAS,CAAC,eAAf,wBACA,kCADA,cAGA,YAAK,SAAS,CAAC,gBAAf,CACA,OAAO,CAAEL,YADT,UAGOjB,cAAc,CAACmD,MAAf,GAA0B,CAA1B,cAGK,wCACA,UAAG,SAAS,CAAC,oBAAb,EADA,cAEA,kCAFA,GAHL,cAYK,YAAI,SAAS,CAAC,aAAd,WAA6BnD,cAAc,CAACmD,MAA5C,OAfZ,EAHA,cAyBA,YAAK,SAAS,CAAC,SAAf,uBACI,cAAM,MAAM,CAAC,EAAb,wBACI,YAAK,SAAS,CAAC,OAAf,uBACI,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,OAA/B,CAAuC,IAAI,CAAC,EAA5C,CAA+C,EAAE,CAAC,EAAlD,CAAqD,KAAK,CAAE5C,KAA5D,CACI,QAAQ,CAAE,kBAACgB,CAAD,QAAMf,CAAAA,QAAQ,CAACe,CAAC,CAACC,MAAF,CAASC,KAAV,CAAd,EADd,EADJ,EADJ,cAMI,YAAK,SAAS,CAAC,OAAf,uBACA,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,OAA/B,CAAuC,IAAI,CAAC,EAA5C,CAA+C,EAAE,CAAC,EAAlD,CACK,KAAK,CAAEhB,KADZ,CAEI,QAAQ,CAAE,kBAACc,CAAD,QAAMb,CAAAA,QAAQ,CAACa,CAAC,CAACC,MAAF,CAASC,KAAV,CAAd,EAFd,EADA,EANJ,cAaI,aAAK,SAAS,CAAC,UAAf,wBACA,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,UAA/B,CAA0C,IAAI,CAAC,EAA/C,CAAkD,EAAE,CAAC,EAArD,CACK,KAAK,CAAEd,QADZ,CAEI,QAAQ,CAAE,kBAACY,CAAD,QAAMX,CAAAA,WAAW,CAACW,CAAC,CAACC,MAAF,CAASC,KAAV,CAAjB,EAFd,EADA,cAKI,UAAG,SAAS,CAAC,mBAAb,EALJ,GAbJ,cAoBI,aAAK,SAAS,CAAC,OAAf,wBACI,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,OAA/B,CAAuC,IAAI,CAAC,EAA5C,CAA+C,EAAE,CAAC,EAAlD,CACA,KAAK,CAAEZ,KADP,CAEA,QAAQ,CAAE,kBAACU,CAAD,QAAMT,CAAAA,QAAQ,CAACS,CAAC,CAACC,MAAF,CAASC,KAAV,CAAd,EAFV,EADJ,cAKI,UAAG,SAAS,CAAC,uBAAb,EALJ,GApBJ,cA4BI,YAAK,SAAS,CAAC,cAAf,uBACI,eAAQ,IAAI,CAAC,QAAb,CAAsB,OAAO,CAAEe,WAA/B,uBACA,KAAC,IAAD,EAAM,EAAE,CAAC,GAAT,qBADA,EADJ,EA5BJ,GADJ,EAzBA,GAPJ,GADA,EAFJ,CAoFC,CAEL,cAAezC,CAAAA,OAAf","sourcesContent":["import React,{useState,useContext} from 'react';\r\nimport './addPost.css';\r\nimport {SideBarContext} from '../../contexts/SideBarContext';\r\nimport {storage,db} from '../../Firebase';\r\nimport firebase from 'firebase/compat';\r\nimport { Zoom } from 'react-reveal';\r\nimport {Link,useNavigate} from 'react-router-dom'\r\n\r\nfunction AddPost() {\r\n\r\n    const [imagesSelected,setImagesSelected] = useState([]);\r\n    const [imagesName,setImagesName] = useState([])\r\n    const {value2} = useContext(SideBarContext);  \r\n    const [activeUser,setActiveUser] = value2;\r\n    const [title,setTitle] = useState('');\r\n    const [price,setPrice] = useState('');\r\n    const [category,setCategory] = useState('');\r\n    const [place,setPlace] = useState('');\r\n\r\n    const navigate = useNavigate()\r\n\r\n\r\n    let i =-1;\r\n    const hundleSelect = ()=> {\r\n        let input = document.getElementById('file');\r\n        input.click();\r\n        i++;    \r\n    }\r\n\r\n    const hundleChange = (e) =>{\r\n        \r\n        if(e.target.value !== ''){\r\n    \r\n            setImagesSelected([e.target.files[i],...imagesSelected]);\r\n            setImagesName([e.target.files[i].name,...imagesName])\r\n                     \r\n        }\r\n    }\r\n    \r\n   \r\n   let j = 0\r\n   let content = [];\r\n   const Add = ()=> {\r\n       db.collection('posts').add({\r\n           productName : title,\r\n           price,\r\n           imagesUrl : content,\r\n           username : activeUser,\r\n           place,\r\n           category,\r\n           timestamp: firebase.firestore.FieldValue.serverTimestamp()\r\n\r\n\r\n       });\r\n       setImagesSelected([])\r\n       navigate('/')\r\n       \r\n   }\r\n    const saveArticle = async(e)=>{\r\n        e.preventDefault();\r\n        \r\n        \r\n         imagesSelected.map( async (image) => { \r\n            \r\n            await storage.ref(`images/${image.name}`).put(image);\r\n            await storage.ref('images').child(image.name).getDownloadURL().then(\r\n                url => {\r\n                    content.unshift(url);\r\n                    j++;\r\n                })\r\n        \r\n           \r\n            if(j === imagesSelected.length) {\r\n                Add()\r\n            }\r\n           \r\n        })\r\n        \r\n    \r\n        setPlace('');\r\n        setTitle('');\r\n        setCategory('');\r\n        setPrice('');\r\n        \r\n\r\n    }\r\n    \r\n    return (\r\n        \r\n        <Zoom>\r\n        <div className=\"container\">\r\n        \r\n        <input type=\"file\" className='file'\r\n            onChange={hundleChange}\r\n            name=\"\" id=\"file\" />\r\n\r\n        \r\n            <div className='add_container'>\r\n            <h3>Add a Post</h3>\r\n\r\n            <div className=\"data_container\"\r\n            onClick={hundleSelect}\r\n            >\r\n                  {imagesSelected.length === 0 ? \r\n                        (\r\n\r\n                        <>\r\n                        <i className=\"fas fa-folder-plus\"></i>\r\n                        <h4>Add images</h4>\r\n                        </>\r\n                        )\r\n                      \r\n                    \r\n                  :\r\n                      (\r\n                        <h4 className='imgs_number'>{imagesSelected.length}+</h4>\r\n                        )\r\n                      \r\n                    \r\n                  }  \r\n\r\n            </div>\r\n            <div className=\"details\">\r\n                <form action=\"\">\r\n                    <div className=\"title\">\r\n                        <input type=\"text\" placeholder='Title' name=\"\" id=\"\" value={title}\r\n                            onChange={(e)=> setTitle(e.target.value)}\r\n                        />\r\n                    </div>\r\n                    <div className=\"price\">\r\n                    <input type=\"text\" placeholder='Price' name=\"\" id=\"\" \r\n                         value={price}\r\n                        onChange={(e)=> setPrice(e.target.value)}\r\n                    />\r\n\r\n                    </div>\r\n                    <div className=\"category\">\r\n                    <input type=\"text\" placeholder='Category' name=\"\" id=\"\" \r\n                         value={category}\r\n                        onChange={(e)=> setCategory(e.target.value)}\r\n                    />\r\n                        <i className=\"fas fa-caret-down\"></i>             \r\n                    </div>\r\n                    <div className=\"place\">\r\n                        <input type=\"text\" placeholder='Place' name=\"\" id=\"\"\r\n                        value={place}\r\n                        onChange={(e)=> setPlace(e.target.value)}\r\n                         />\r\n                        <i className=\"fas fa-map-marker-alt\"></i>\r\n                    </div>\r\n\r\n                    <div className=\"save_article\">\r\n                        <button type='submit' onClick={saveArticle}>\r\n                        <Link to='/'>\r\n                        Publish\r\n                        </Link>\r\n                        </button>\r\n                    </div>\r\n\r\n                    \r\n                </form>\r\n            </div>\r\n\r\n        \r\n            </div>\r\n            \r\n        </div>\r\n        \r\n        </Zoom>\r\n        \r\n    )\r\n    }\r\n\r\nexport default AddPost\r\n"]},"metadata":{},"sourceType":"module"}